# webapp/mysql/conf.d/my.cnf
# Conservative MySQL configuration for stability

[mysqld]
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
lower_case_table_names=1
secure_file_priv="/docker-entrypoint-initdb.d/csv"

# Conservative buffer pool size for stability
innodb_buffer_pool_size = 1G
innodb_buffer_pool_instances = 2

# Increase maximum number of connections
max_connections = 80

# Basic InnoDB optimization
innodb_log_buffer_size = 32M
innodb_flush_log_at_trx_commit = 2

# Increase packet sizes
max_allowed_packet=1G
ngram_token_size=2

# Disable unnecessary logs for performance
disable-log-bin
performance_schema = OFF
slow_query_log = OFF
general_log = OFF

# Temporary table settings
tmp_table_size = 64M
max_heap_table_size = 64M

# Thread cache settings
thread_cache_size = 25

# Sorting settings
sort_buffer_size = 1M
read_buffer_size = 128K
read_rnd_buffer_size = 256K
join_buffer_size = 1M

[mysqldump]
max_allowed_packet = 1G

[client]
default-character-set = utf8mb4